---
title: ã€Šæ ‘èŽ“æ´¾ä¸åƒç°ã€‹ç¬¬åä¹æœŸï¼šåœ¨æ ‘èŽ“æ´¾æ­å»ºç§äººéŸ³ä¹æœåŠ¡å™¨navidromeï¼Œå¹¶æ”¯æŒæ˜¾ç¤ºæ­Œè¯ / ã€ŠUse Piã€‹ Issue 19 Build a private music server navidrome on Raspberry Pi, and support the display of lyrics
categories:
- æ ‘èŽ“æ´¾ä¸åƒç° / Use Pi
---

2023å¹´ï¼Œå›½äº§ç¡¬ç›˜ä»·æ ¼çœŸçš„æ˜¯ç»æµŽå®žæƒ ï¼Œè€Œç‰ˆæƒä¹‹äº‰å¯¼è‡´æˆ‘ä»¬æ— æ³•ä»Žå•ä¸ªå¹³å°èŽ·å–æƒ³å¬çš„æ­Œï¼Œæœ¬æœŸæˆ‘ä»¬å°†åœ¨æ ‘èŽ“æ´¾æ­å»ºä¸€ä¸ªnavidromeç§äººéŸ³ä¹æœåŠ¡å™¨ï¼ŒåŒæ—¶æ”¯æŒæ˜¾ç¤ºæ­Œè¯ã€‚ï¼ˆè™½ç„¶jellyfinä¹Ÿæ”¯æŒç®¡ç†æ­Œæ›²ï¼Œä½†ä¸æ”¯æŒæ˜¾ç¤ºæ­Œè¯ï¼Œæˆ‘è®¤ä¸ºæ˜¾ç¤ºæ­Œè¯æ˜¯åˆšéœ€ï¼Œæœ€ç»ˆé€‰æ‹©äº†navidromeï¼‰

ðŸŒˆIn 2023, the price of domestic hard drives is really economical, and the copyright dispute makes it impossible for us to get the songs we want to hear from a single platform. In this issue, we will build a navidrome private music server on the Raspberry Pi, which also supports displaying lyrics. (Although jellyfin also supports song management, it does not support displaying lyrics. I think displaying lyrics is a rigid demand, so I finally chose navidrome.)

æœ¬æ–‡æ˜¯ã€Šæ ‘èŽ“æ´¾ä¸åƒç°ã€‹ç³»åˆ—çš„ç¬¬19æœŸï¼Œæ¶‰åŠåˆ°çš„æ­å»ºdocker , samba, frpæœåŠ¡ï¼Œåœ¨å‰é¢çš„ç¯‡ç« å·²å‘è¡¨è¯¦ç»†çš„å›¾æ–‡æ•™ç¨‹ï¼Œå¦‚æžœé‡åˆ°å›°éš¾ï¼Œè¯·æŸ¥çœ‹ github.com/zhaoolee/pi

ðŸŒˆThis article is the 19th issue of the "Use Pi" series. The construction of docker, samba, and frp services involved has been detailed in the previous chapters. If you encounter difficulties, please check github.com/zhaoolee/pi




## åœ¨æ ‘èŽ“æ´¾é€šè¿‡docker composeå®‰è£…å¹¶è¿è¡Œnavidrome / Install and run navidrome on Raspberry Pi through docker compose


```
# åˆ›å»ºæ•°æ®ç›®å½• / Creating data directory
mkdir -p /opt/navidrome/data
# åˆ›å»ºéŸ³ä¹ç›®å½• / Creating music directory
mkdir /opt/navidrome/music
# è®¾ç½®æƒé™ / Setting permissions
chmod 777 -R  /opt/navidrome
# è¿›å…¥navidromeç›®å½• / Enter navidrome directory
cd /opt/navidrome
# åˆ›å»ºdocker-compose.ymlæ–‡ä»¶ / Creating docker-compose.yml file
touch docker-compose.yml
# è®¾ç½®docker-compose.ymlæ–‡ä»¶æƒé™ / Setting docker-compose.yml file permissions
chmod 777 docker-compose.yml
```

å¾€`docker-compose.yml`å†™å…¥ä»¥ä¸‹å†…å®¹

ðŸŒˆWrite the following content into `docker-compose.yml`


```
version: "3"
services:
  navidrome:
    image: deluan/navidrome:latest
    user: 1000:1000 # should be owner of volumes
    ports:
      - "4533:4533"
    restart: unless-stopped
    environment:
      # Optional: put your config options customization here. Examples:
      ND_SCANSCHEDULE: 1h
      ND_LOGLEVEL: info  
      ND_SESSIONTIMEOUT: 24h
      ND_BASEURL: ""
    volumes:
      - "/opt/navidrome/data:/data"
      - "/opt/navidrome/music:/music:ro"
```

å‘½ä»¤è¡Œç‰ˆæœ¬:
ðŸŒˆCommand Line Version:

```
sudo bash -c 'cat > /opt/navidrome/docker-compose.yml' <<-'EOF'
version: "3"
services:
  navidrome:
    image: deluan/navidrome:latest
    user: 1000:1000 # should be owner of volumes
    ports:
      - "4533:4533"
    restart: unless-stopped
    environment:
      # Optional: put your config options customization here. Examples:
      ND_SCANSCHEDULE: 1h
      ND_LOGLEVEL: info  
      ND_SESSIONTIMEOUT: 24h
      ND_BASEURL: ""
    volumes:
      - "/opt/navidrome/data:/data"
      - "/opt/navidrome/music:/music:ro"
EOF
```

å¯åŠ¨navidrome
ðŸŒˆStart navidrome


```
cd /opt/navidrome
sudo docker-compose up -d
```

å¯åŠ¨æˆåŠŸåŽ
ðŸŒˆAfter successful startup

![image-20230718151100407](https://cdn.fangyuanxiaozhan.com/assets/1689664261296xSkCpEAi.png)

## è®¿é—® `æ ‘èŽ“æ´¾å±€åŸŸç½‘ip:4533` / Access `Raspberry Pi LAN IP:4533`


![image-20230718151225626](https://cdn.fangyuanxiaozhan.com/assets/1689664346395K4Jfa2dH.png)

åˆ›å»ºæ–°ç”¨æˆ·ï¼Œå¹¶è‡ªåŠ¨å®Œæˆç™»å½•

ðŸŒˆCreate a new user and automatically log in

![image-20230718151351362](https://cdn.fangyuanxiaozhan.com/assets/1689664431913Z6hkQpfC.png)


ç™»å½•æˆåŠŸ

ðŸŒˆLogin successful

![image-20230718151424982](https://cdn.fangyuanxiaozhan.com/assets/1689664465563H45nE2Dw.png)



ç›®å‰æˆ‘ä»¬è¿˜æ²¡æœ‰å¾€`/opt/navidrome/music`æ”¾ä»»ä½•èµ„æºï¼Œæ‰€ä»¥ä»€ä¹ˆéƒ½æ²¡æœ‰ï¼Œä¸‹ä¸€æ­¥æˆ‘ä»¬å°†ä»ŽQQéŸ³ä¹ä¸‹è½½ä¸€äº›èµ„æº


ðŸŒˆAt present, we have not put any resources in `/opt/navidrome/music`, so there is nothing. Next, we will download some resources from QQ Music


## ä»ŽQQéŸ³ä¹ä¸‹è½½mp3æ ¼å¼çš„æ­Œæ›²å’Œå¯¹åº”lrcæ­Œè¯æ–‡ä»¶ / Download mp3 format songs and corresponding lrc lyric files from QQ Music

è¿™é‡Œé€‰æ‹©QQéŸ³ä¹æ˜¯å› ä¸ºQQéŸ³ä¹æ­Œæ¯”è¾ƒå…¨ï¼Œä¸‹è½½æ¯”è¾ƒæ–¹ä¾¿ï¼Œä»Žç½‘ç»œä¸‹è½½èµ„æºï¼Œæˆ–æ‰¾å…¶å®ƒäººçš„å…±äº«èµ„æºï¼Œéƒ½æ˜¯å¯ä»¥çš„


ðŸŒˆThe reason for choosing QQ Music is that QQ Music has a wide range of songs, and it is convenient to download. It is possible to download resources from the Internet or find shared resources from others.

![image-20230718151950869](https://cdn.fangyuanxiaozhan.com/assets/1689664791347JExkSYRp.png)



![image-20230718152124721](https://cdn.fangyuanxiaozhan.com/assets/1689664885073BQBS80hA.png)



ä¸‹è½½å®ŒæˆåŽï¼Œå³é”®æµè§ˆæœ¬åœ°æ–‡ä»¶

ðŸŒˆAfter the download is complete, right-click to browse local files


![image-20230718152212353](https://cdn.fangyuanxiaozhan.com/assets/1689664932744Ztz0Yj3t.png)

æˆ‘ä»¬å¯ä»¥æŸ¥çœ‹åˆ°ä¸‹è½½å¥½çš„æ–‡ä»¶

ðŸŒˆWe can see the downloaded files

![image-20230718152334926](https://cdn.fangyuanxiaozhan.com/assets/1689665015377cMwT1xP4.png)



## å°†æ–‡ä»¶æ‹·è´åˆ°æ¡Œé¢ï¼Œè§£é”mp3æ–‡ä»¶ / Copy the files to the desktop and unlock the mp3 files

å°†ä¸Šé¢ä¸¤ä¸ªæ–‡ä»¶æ‹·è´åˆ°æ¡Œé¢åŽï¼Œæ‰“å¼€https://demo.unlock-music.dev/ å°†mp3æ–‡ä»¶æ‹–æ‹½åˆ°ç½‘é¡µè™šçº¿åŒºï¼Œè¿›è¡Œè§£é”

ðŸŒˆAfter copying the above two files to the desktop, open https://demo.unlock-music.dev/ and drag the mp3 file to the dashed area of the webpage to unlock


![image-20230718152747657](https://cdn.fangyuanxiaozhan.com/assets/1689665268130aAh1JCZ7.png)

ä¸‹è½½è§£é”æˆåŠŸçš„mp3æ–‡ä»¶

ðŸŒˆDownload the successfully unlocked mp3 file

![image-20230718152829909](https://cdn.fangyuanxiaozhan.com/assets/1689665310281c8MK3aSz.png)





![image-20230718152958711](https://cdn.fangyuanxiaozhan.com/assets/1689665399194HKH3EHiS.png)





## ç”¨mp3tagå°†lrcä¿¡æ¯å†™å…¥mp3æ–‡ä»¶tagä¸ºUNSYNCEDLYRICSçš„å­—æ®µ / Use mp3tag to Write lrc Information into the UNSYNCEDLYRICS Field of mp3 File Tag

ä¸‹è½½å®‰è£…mp3tag  https://www.mp3tag.de/en/download.html

ðŸŒˆDownload and install mp3tag: https://www.mp3tag.de/en/download.html

![image-20230718153137327](https://cdn.fangyuanxiaozhan.com/assets/1689665497704bxAnDMJN.png)

å°†è§£é”åŽçš„æ–‡ä»¶æ‹–æ‹½åˆ°mp3tag

ðŸŒˆDrag the unlocked file to mp3tag

![image-20230718153505398](https://cdn.fangyuanxiaozhan.com/assets/1689665705816ERer4R0k.png)

å³é”®mp3æ–‡ä»¶, Extended Tags

ðŸŒˆRight-click the mp3 file, select Extended Tags

![image-20230718153614745](https://cdn.fangyuanxiaozhan.com/assets/1689665775469NHGKhsJJ.png)

æ–°å¢žå­—æ®µï¼Œ Add Filed

ðŸŒˆAdd a field, Add Field

![image-20230718153725838](https://cdn.fangyuanxiaozhan.com/assets/1689665846385SzNk6K8K.png)

Fieldå†…è¾“å…¥UNSYNCEDLYRICS

ðŸŒˆEnter UNSYNCEDLYRICS in the Field

![image-20230718153836713](https://cdn.fangyuanxiaozhan.com/assets/16896659171708SsGmMNb.png)

Valueå†…å¡«å…¥ lrcæ–‡ä»¶å†…çš„æ–‡æœ¬

ðŸŒˆEnter the text from the lrc file in the Value

![image-20230718154456590](https://cdn.fangyuanxiaozhan.com/assets/1689666297081MjXSQGAk.png)

![image-20230718154628251](https://cdn.fangyuanxiaozhan.com/assets/1689666388746ByeEP5yp.png)

![image-20230718154709513](https://cdn.fangyuanxiaozhan.com/assets/1689666429873fRdpabAA.png)
## å°†ä¿®æ”¹å®Œæˆçš„æ–‡ä»¶ï¼Œæ”¾å…¥æ ‘èŽ“æ´¾musicæ–‡ä»¶å¤¹ä¸­ / Put the Modified Files into the Raspberry Pi's music Folder

è¿™é‡Œçš„musicæ–‡ä»¶å¤¹ï¼Œå°±æ˜¯å‰é¢åˆ›å»ºçš„ `/opt/navidrome/music`

ðŸŒˆThe music folder here is the `/opt/navidrome/music` created earlier.

![image-20230718154922692](https://cdn.fangyuanxiaozhan.com/assets/1689666881500sXdwzhWr.png)

## åˆ·æ–°å³å¯æ’­æ”¾å¹¶å¼€å¯æ­Œè¯æ˜¾ç¤º / Refresh to Play and Start Displaying Lyrics

![image-20230718155248906](https://cdn.fangyuanxiaozhan.com/assets/16896667693237s7nCiwb.png)

![image-20230718155353855](https://cdn.fangyuanxiaozhan.com/assets/1689666834348YH2a0tG4.png)











## ä½¿ç”¨frpå®Œæˆå†…ç½‘ç©¿é€ / Using frp to Achieve Intranet Penetration

åœ¨æ ‘èŽ“æ´¾é…ç½®æ–‡ä»¶frpc.iniä¸­æ·»åŠ ä»¥ä¸‹é…ç½®

ðŸŒˆAdd the following configuration in the Raspberry Pi configuration file frpc.ini

```
[navidrome-frp-v2fy-com-4533]
type = tcp
local_ip = 127.0.0.1
local_port = 4533
remote_port = 4533
```


## å¯ä»¥ä½¿ç”¨å…¬ç½‘è®¿é—®ç§äººéŸ³ä¹æœåŠ¡äº† / Now You Can Use the Public Network to Access Private Music Services

é‡å¯æ ‘èŽ“æ´¾çš„frpcåŽï¼Œnavidromeå·¥ä½œçš„4533ç«¯å£å°†ä¼šè¢«æ˜ å°„åˆ°äº‘æœåŠ¡å™¨ï¼Œæˆ‘ä»¬å°±å¯ä»¥åœ¨å¤–ç½‘è®¿é—®æ ‘èŽ“æ´¾çš„navidromeæœåŠ¡äº†

ðŸŒˆAfter restarting the frpc on the Raspberry Pi, the 4533 port where navidrome works will be mapped to the cloud server, and we can access the navidrome service on the Raspberry Pi from the public network.

![image-20230718160704784](https://cdn.fangyuanxiaozhan.com/assets/16896676254810Yfk2Ki7.png)



## åˆ‡æ¢æ˜¾ç¤ºè¯­è¨€ / Switch Display Language



![image-20230718160803641](https://cdn.fangyuanxiaozhan.com/assets/1689667684194EXjXKJnP.png)



![image-20230718160839157](https://cdn.fangyuanxiaozhan.com/assets/1689667719659dyDANdDj.png)





## å¯ä»¥å°è¯•å¤šç§ä¸»é¢˜çš®è‚¤ / You Can Try Various Theme Skins



![image-20230718160938871](https://cdn.fangyuanxiaozhan.com/assets/16896677793876MbbyRQN.png)



## çª„å±æ‰‹æœºç‰ˆé€‚é…ä¾ç„¶ç¾Žè§‚ / Narrow Screen Mobile Version Still Looks Good



![image-20230718161047171](https://cdn.fangyuanxiaozhan.com/assets/16896678477030TDjEmPx.png)





## å°ç»“ / Summary

æœ€è¿‘æ‰“å¼€éŸ³ä¹è½¯ä»¶ï¼ŒæŽ¨é€çš„æ­Œæ›²å®žåœ¨ä¸å¥½å¬ï¼Œæœ‰ç‚¹æƒ³å¿µè€å¼çš„mp3, æ­Œæ›²æ•°é‡è™½ç„¶æœ‰é™ï¼Œä½†æ¯é¦–éƒ½å¥½å¬ï¼Œæ¯é¦–éƒ½ç†Ÿæ‚‰ã€‚äºŽæ˜¯äº§ç”Ÿäº†æ­å»ºç§äººéŸ³ä¹æœåŠ¡å™¨çš„æƒ³æ³•ï¼Œä¸€å¥—æŠ˜è…¾ä¸‹æ¥ï¼Œä½“éªŒè¿˜ä¸é”™ã€‚

ðŸŒˆRecently, the songs pushed by the music app were really not good. I missed the old-fashioned mp3 a bit. Although the number of songs was limited, every song sounded good and every song was familiar. So, I had the idea of setting up a private music server. After a set of tinkering, the experience was not bad.

